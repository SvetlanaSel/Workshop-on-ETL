# Лабораторная работа №2. Динамические соединения с базами данных. Вариант 13

**Цель работы.** Получить практические навыки создания сложного ETL-процесса, включающего динамическую загрузку файлов по HTTP, нормализацию базы данных, обработку дубликатов и настройку обработки ошибок с использованием Pentaho Data Integration (PDI).

---
## 1. Техническое обеспечение и окружение

Шаг был выполнен заранее

---

## 2. Подготовка базы данных

С помощью представленного SQL-кода были созданы таблицы в базе данных:

<img width="1128" height="367" alt="image" src="https://github.com/user-attachments/assets/eada94ac-45ba-4df6-a4f2-530d10bb9a8d" />

---

## 3. Ход работы

### Шаг 1. Настройка Job (Главного задания)

Шаг был выполнен заранее

### Шаг 2. Реализация Трансформаций (Transformations)

#### Трансформация 1. Load Orders
1.  **Select Values.** Установлены типы данных (Date format: `dd.MM.yyyy` для дат, Integer для ID).
2.  **Memory Group By.** Используется для дедупликации (группировка по `row_id`, взятие первых значений по остальным полям).
3.  **Filter Rows (Валидация):**
    *   Условие: `order_date IS NOT NULL` AND `ship_date IS NOT NULL` AND `state = 'Texas'`.
    *   TRUE -> **Table Output** (в таблицу `orders`).
    *   FALSE -> **Write to Log** (логирование ошибок).
4.  **Value Mapper.** Преобразование поля `Returned`: `Yes` -> `1`, `No` -> `0`, `Empty` -> `0`.

#### Трансформация 2. Load Customers
1.  **Select Values.** Оставьте только поля, относящиеся к клиенту (`customer_id`, `name`, `city` и т.д.).
2.  **Memory Group By.** Группировка по `customer_id` (устранение дублей клиентов).
3.  **Table Output.** Загрузка в таблицу `customers`.

#### Трансформация 3. Load Products
1.  **Select Values.** Оставьте поля продукта (`product_id`, `category`, `name` и т.д.).
2.  **Memory Group By.** Группировка по `product_id`.
3.  **Table Output.** Загрузка в таблицу `products`.

---

## 4. Варианты индивидуальных заданий
